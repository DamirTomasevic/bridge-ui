package encoding

import (
	"testing"

	"github.com/ethereum/go-ethereum/common/hexutil"
	"gopkg.in/go-playground/assert.v1"
)

func Test_EncodeStorageProof(t *testing.T) {
	// nolint: lll
	accountProof := "0x00edb9377a94f02e691ea208a80a7bd13dcb51dfae3a389d3001a55c5fdf3f3ae70807df1d8ffcaeefa5dc56875a03dae3494d93bbf3074018fea52137a098433d9795f455fcfaf89b6456b970605bd0f70bec98418ef322fa5bba9874ab2277225a38c19f99275cd6d25d9cd4259c366c02b750056a6b71810034f95d34ae12c1298a95e6ba03de90dbbfacc5c8edbeb6ed93a0e01c08f3435b1ca944e9229a176804445432795c14dc315925fe2480084d6b0729c30fb1c2e50e481df5d7daa25769a0c74baf362ff02f2a934538cd11bf939f64377489255aa60a12628b130f4bddd30664d6b5f91d17cc110bee38a7ce5c629585e57d777bfbb2eaf09e15"
	// nolint: lll
	storageProof := "0xfdb3b1c60d5e8417c0c2c1023544837fb73612bbc7511bf30dd0b2e282f1618a7b39a9baa238904acf33a97b1617f4a971da22ac40faf828ceb651f76be9df259f91037b93fcc1e8c9c8004f84aff0fafa4e446c30a4cef66a5a9cf529541d40d49ba6c2c64311cb221d3b80c622e886ec3d6780a6bdb6c47fe4f2d9a8704ccdb9bb29feb58e79b81b5e24d39be45c32d9161b1b36fb49f36404c9bea5c505862a463b07c178e6b28ff53f23ecaa5f2ae02f2db4e57a2fc2aa4a014dc0fa6f835881dc0f1cda6ee66f32141e5a421731ce5e19d875aad61284a33b9e1bc6c895098b1f347063109403551360b675a443b06c6675fd6554e7245ee95036928665"
	// nolint: lll
	want := "0x00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000010000edb9377a94f02e691ea208a80a7bd13dcb51dfae3a389d3001a55c5fdf3f3ae70807df1d8ffcaeefa5dc56875a03dae3494d93bbf3074018fea52137a098433d9795f455fcfaf89b6456b970605bd0f70bec98418ef322fa5bba9874ab2277225a38c19f99275cd6d25d9cd4259c366c02b750056a6b71810034f95d34ae12c1298a95e6ba03de90dbbfacc5c8edbeb6ed93a0e01c08f3435b1ca944e9229a176804445432795c14dc315925fe2480084d6b0729c30fb1c2e50e481df5d7daa25769a0c74baf362ff02f2a934538cd11bf939f64377489255aa60a12628b130f4bddd30664d6b5f91d17cc110bee38a7ce5c629585e57d777bfbb2eaf09e150000000000000000000000000000000000000000000000000000000000000100fdb3b1c60d5e8417c0c2c1023544837fb73612bbc7511bf30dd0b2e282f1618a7b39a9baa238904acf33a97b1617f4a971da22ac40faf828ceb651f76be9df259f91037b93fcc1e8c9c8004f84aff0fafa4e446c30a4cef66a5a9cf529541d40d49ba6c2c64311cb221d3b80c622e886ec3d6780a6bdb6c47fe4f2d9a8704ccdb9bb29feb58e79b81b5e24d39be45c32d9161b1b36fb49f36404c9bea5c505862a463b07c178e6b28ff53f23ecaa5f2ae02f2db4e57a2fc2aa4a014dc0fa6f835881dc0f1cda6ee66f32141e5a421731ce5e19d875aad61284a33b9e1bc6c895098b1f347063109403551360b675a443b06c6675fd6554e7245ee95036928665"
	proof, err := EncodeStorageProof(hexutil.MustDecode(accountProof), hexutil.MustDecode(storageProof))
	assert.Equal(t, nil, err)
	assert.Equal(t, hexutil.Encode(proof), want)
}
